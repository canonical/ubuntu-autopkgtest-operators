type: charm
name: ubuntu-autopkgtest-website
title: Charm Template
summary: Website for the autopkgtest service
description: Website for the autopkgtest service
links:
  issues:
    - https://github.com/canonical/ubuntu-autopkgtest-operators/issues
  source:
    - https://github.com/canonical/ubuntu-autopkgtest-operators

base: ubuntu@24.04
platforms:
  amd64:

parts:
  charm:
    plugin: charm
    source: .
  website:
    plugin: dump
    source: app
    organize:
      www: app/www

charm-libs:
  - lib: traefik_k8s.ingress
    version: "2"

config:
  options:
    hostname:
      type: string
      description: Website hostname, e.g. autopkgtest.ubuntu.com
      default: localhost
    releases:
      type: string
      description: Space-separated list of releases to display information for
      default: noble resolute

    # swift options
    swift-auth-url:
      type: string
      description: swift auth URL
      default: ""
    swift-project-domain-name:
      type: string
      description: swift project domain name
      default: ""
    swift-project-name:
      type: string
      description: swift project name
      default: ""
    swift-storage-url:
      type: string
      description: swift storage url
      default: ""
    swift-user-domain-name:
      type: string
      description: swift user domain name
      default: ""
    swift-username:
      type: string
      description: swift username
      default: ""
    swift-juju-secret:
      type: secret
      description: juju secret id holding the swift password

requires:
  amqp:
    interface: rabbitmq
    limit: 1
  ingress:
    interface: ingress
    limit: 1
